# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ ESP32-S3: PSRAM –∏ Flash –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

## üö® –î–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –û—à–∏–±–∫–∞ PSRAM: "Insufficient PSRAM: 0 bytes"

```
[E][ov2640.cpp:432] checkMemoryConstraints(): [OV2640] Insufficient PSRAM: 0 bytes
```

### 2. –û—à–∏–±–∫–∞ Flash: "Octal Flash option selected, but EFUSE not configured!"

```
E (199) cpu_start: Octal Flash option selected, but EFUSE not configured!
abort() was called at PC 0x40376bed on core 0
```

## ‚úÖ –ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `platformio.ini`

```ini
[env:esp32s3_fpv_drone]
platform = espressif32
board = rymcu-esp32-s3-devkitc-1       ; ‚úÖ ESP32-S3 —Å 8MB Flash + 2MB PSRAM
framework = arduino

; === –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ===
upload_speed = 921600                    ; –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏
monitor_speed = 115200                   ; –°–∫–æ—Ä–æ—Å—Ç—å Serial –º–æ–Ω–∏—Ç–æ—Ä–∞
monitor_filters = esp32_exception_decoder ; –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

; === –ö–†–ò–¢–ò–ß–ù–û: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Flash –∏ PSRAM ===
board_build.flash_mode = dio            ; ‚úÖ Dual I/O —Ä–µ–∂–∏–º (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π)
board_build.flash_size = 8MB            ; ‚úÖ –†–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä Flash
board_build.psram_type = qio            ; ‚úÖ Quad I/O PSRAM (—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π)
board_build.partitions = huge_app.csv   ; –ë–æ–ª—å—à–∏–µ —Ä–∞–∑–¥–µ–ª—ã –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

; === –§–ª–∞–≥–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ ===
build_flags =
    -DCORE_DEBUG_LEVEL=1                ; –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –æ—Ç–ª–∞–¥–∫–∏
    -DCONFIG_CAMERA_MODULE_ESP32S3_EYE  ; –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ESP32-S3 –∫–∞–º–µ—Ä—ã
    -DBOARD_HAS_PSRAM                   ; –ü–ª–∞—Ç–∞ –∏–º–µ–µ—Ç PSRAM
    -DCONFIG_ESP32S3_SPIRAM_SUPPORT=1   ; –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SPIRAM
    -DCONFIG_SPIRAM_USE_MALLOC=1        ; –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PSRAM –¥–ª—è malloc
    -DPSRAM_MODE=1                      ; –í–∫–ª—é—á–∏—Ç—å PSRAM
    -DCONFIG_ESP32S3_DEFAULT_CPU_FREQ_240=1 ; 240MHz CPU
    -Os                                 ; –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∫–æ–¥–∞

; === –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ ===
lib_deps =
    espressif/esp32-camera@^2.0.4      ; –î—Ä–∞–π–≤–µ—Ä –∫–∞–º–µ—Ä—ã ESP32
```

### –®–∞–≥ 2: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PSRAM –≤ –∫–æ–¥–µ

–í `src/main.cpp` –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É PSRAM:

```cpp
void setup() {
    Serial.begin(115200);
    delay(2000);

    // ‚úÖ –ö–†–ò–¢–ò–ß–ù–û: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PSRAM
    if (!psramInit()) {
        Serial.println("[ERROR] ‚ùå PSRAM initialization failed!");
        Serial.println("[INFO] Check your board - ESP32-S3 with PSRAM required");
        while(1) delay(1000); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
    }

    Serial.printf("[PSRAM] ‚úÖ PSRAM initialized: %lu bytes available\n", ESP.getFreePsram());
    Serial.printf("[HEAP] üíæ Free heap: %lu bytes\n", ESP.getFreeHeap());

    // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
}
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–ª–∞—Ç—ã

### ‚úÖ –ü–†–û–í–ï–†–ï–ù–ù–´–ï –ø–ª–∞—Ç—ã (—Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ):

1. **rymcu-esp32-s3-devkitc-1** - 8MB Flash + 2MB PSRAM (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
2. **adafruit_feather_esp32s3** - 4MB Flash + 2MB PSRAM
3. **adafruit_qtpy_esp32s3_n4r2** - 4MB Flash + 2MB PSRAM

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ù–´–ï –ø–ª–∞—Ç—ã (–º–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ Flash):

- **freenove_esp32_s3_wroom** - 8MB PSRAM, –Ω–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OPI —Ä–µ–∂–∏–º
- **esp32-s3-devkitc-1** - –ù–µ—Ç PSRAM –≤–æ–æ–±—â–µ

### ‚ùå –ù–ï –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–ª–∞—Ç—ã:

- **esp32-s3-devkitc-1** - No PSRAM
- **adafruit_feather_esp32s3_nopsram** - No PSRAM
- **adafruit_qtpy_esp32s3_nopsram** - No PSRAM

## üîß –ü–æ—à–∞–≥–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤—å—Ç–µ platformio.ini:

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–≤–µ—Ä—Ö—É
```

### 2. –û—á–∏—Å—Ç–∏—Ç–µ —Å—Ç–∞—Ä—É—é —Å–±–æ—Ä–∫—É:

```bash
pio run --target clean
```

### 3. –°–æ–±–µ—Ä–∏—Ç–µ –∑–∞–Ω–æ–≤–æ:

```bash
pio run
```

### 4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
pio run --target upload --target monitor
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ Serial –º–æ–Ω–∏—Ç–æ—Ä–µ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:

```
[PSRAM] ‚úÖ PSRAM initialized: 2097152 bytes available  ; 2MB PSRAM
[HEAP] üíæ Free heap: 320000 bytes
ESP32-S3 Drone Camera System v3.0 - Dual Core
==================================================
[SYSTEM] Initializing system components...
[MEMORY] Initial free heap: 180 KB
[MEMORY] Initial free PSRAM: 2048 KB
[SUCCESS] Camera initialized successfully
```

## üö® –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "EFUSE not configured"

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `flash_mode = dio` (–Ω–µ qio/opi)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `psram_type = qio` (–Ω–µ opi)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø–ª–∞—Ç—ã –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "PSRAM still 0 bytes"

- ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É –ø–ª–∞—Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å PSRAM
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–π–∫—É PSRAM —á–∏–ø–∞ (–µ—Å–ª–∏ —Å–∞–º–æ–¥–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç–∞)
- ‚úÖ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é –ø–ª–∞—Ç—É –∏–∑ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ó–∞–≤–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `upload_speed = 115200` (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ)
- ‚úÖ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π USB –∫–∞–±–µ–ª—å
- ‚úÖ –°–±—Ä–æ—Å—å—Ç–µ ESP32-S3 –≤ —Ä–µ–∂–∏–º –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Ä—É—á–Ω—É—é

## üí° –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **PSRAM –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞** - –±–µ–∑ –Ω–µ—ë –∫–∞–º–µ—Ä–∞ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
2. **–ú–∏–Ω–∏–º—É–º 2MB PSRAM** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã
3. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ OPI —Ä–µ–∂–∏–º—ã** - –æ–Ω–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã –Ω–∞ –º–Ω–æ–≥–∏—Ö –ø–ª–∞—Ç–∞—Ö
4. **DIO —Ä–µ–∂–∏–º Flash** —Å–∞–º—ã–π —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π
5. **–ü–ª–∞—Ç—ã —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π** –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

---

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å PSRAM! üéØ
