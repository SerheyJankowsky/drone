# üõ†Ô∏è –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ ESP32-S3 FPV Drone Camera

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–±–æ—Ç–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–ü–ª–∞—Ç–∞**: ESP32-S3 N16R8 CAM (16MB Flash, 8MB PSRAM)
- **–ö–∞–º–µ—Ä–∞**: OV2640 –∏–ª–∏ OV5640
- **–ü–û**: PlatformIO IDE –∏–ª–∏ Arduino IDE —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π ESP32-S3
- **–ö–∞–±–µ–ª—å**: USB-C –¥–ª—è –ø—Ä–æ—à–∏–≤–∫–∏ –∏ –ø–∏—Ç–∞–Ω–∏—è

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PlatformIO (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ß–µ—Ä–µ–∑ pip
pip install platformio

# –ò–ª–∏ —á–µ—Ä–µ–∑ VS Code
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ PlatformIO IDE
```

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–±–æ—Ä–∫–∞

```bash
git clone <repository-url>
cd drone
pio run
```

### 2. –ü—Ä–æ—à–∏–≤–∫–∞ –ø–ª–∞—Ç—ã

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ ESP32-S3 —á–µ—Ä–µ–∑ USB
pio run --target upload
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ (115200 baud)
pio run --target monitor
```

### 4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –¥—Ä–æ–Ω—É

1. –ù–∞–π–¥–∏—Ç–µ WiFi —Å–µ—Ç—å: **ESP32-S3_Drone_30fps**
2. –ü–∞—Ä–æ–ª—å: **drone2024**
3. –û—Ç–∫—Ä–æ–π—Ç–µ: **http://192.168.4.1:8080**

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∏–Ω–æ–≤ –∫–∞–º–µ—Ä—ã

### ESP32-S3 CAM —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∏–Ω—ã:

```cpp
// –í include/ov2640.h –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:
namespace CameraPins {
    constexpr int PWDN = -1;      // –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
    constexpr int RESET = -1;     // –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
    constexpr int XCLK = 15;      // –¢–∞–∫—Ç–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª
    constexpr int SIOD = 4;       // I2C SDA
    constexpr int SIOC = 5;       // I2C SCL
    constexpr int Y9 = 16;        // –î–∞–Ω–Ω—ã–µ D7
    constexpr int Y8 = 17;        // –î–∞–Ω–Ω—ã–µ D6
    constexpr int Y7 = 18;        // –î–∞–Ω–Ω—ã–µ D5
    constexpr int Y6 = 12;        // –î–∞–Ω–Ω—ã–µ D4
    constexpr int Y5 = 10;        // –î–∞–Ω–Ω—ã–µ D3
    constexpr int Y4 = 8;         // –î–∞–Ω–Ω—ã–µ D2
    constexpr int Y3 = 9;         // –î–∞–Ω–Ω—ã–µ D1
    constexpr int Y2 = 11;        // –î–∞–Ω–Ω—ã–µ D0
    constexpr int VSYNC = 6;      // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
    constexpr int HREF = 7;       // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
    constexpr int PCLK = 13;      // –ü–∏–∫—Å–µ–ª—å–Ω—ã–π —Ç–∞–∫—Ç
}
```

### –ï—Å–ª–∏ –ø–∏–Ω—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –≤–∞—à–µ–π –ø–ª–∞—Ç–æ–π:

1. –ù–∞–π–¥–∏—Ç–µ —Å—Ö–µ–º—É –≤–∞—à–µ–π –ø–ª–∞—Ç—ã ESP32-S3 CAM
2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–∏–Ω—ã –≤ `include/ov2640.h`
3. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç: `pio run`

## üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ FPS –∏ –∫–∞—á–µ—Å—Ç–≤–∞

```cpp
// –í include/ov2640.h
namespace CameraConfig {
    constexpr uint8_t TARGET_FPS = 30;     // –¶–µ–ª–µ–≤–æ–π FPS
    constexpr uint8_t JPEG_QUALITY = 8;    // –ö–∞—á–µ—Å—Ç–≤–æ JPEG (0-63, –º–µ–Ω—å—à–µ = –ª—É—á—à–µ)
    constexpr framesize_t FRAME_SIZE = FRAMESIZE_QVGA;  // –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ
}
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:

- `FRAMESIZE_QQVGA` - 160x120 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π FPS)
- `FRAMESIZE_QVGA` - 320x240 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `FRAMESIZE_VGA` - 640x480 (—Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
- `FRAMESIZE_SVGA` - 800x600 (–≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
- `FRAMESIZE_UXGA` - 1600x1200 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WiFi

```cpp
// –í src/wifi/wifi_module.cpp, —Ñ—É–Ω–∫—Ü–∏—è init()
wifi.init("–í–ê–®_SSID", "–í–ê–®_–ü–ê–†–û–õ–¨");
```

## üîç Serial –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

–ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Serial –º–æ–Ω–∏—Ç–æ—Ä—É (115200 baud) –¥–æ—Å—Ç—É–ø–Ω—ã –∫–æ–º–∞–Ω–¥—ã:

```
help          - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã
status        - –ü–æ–ª–Ω—ã–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
camera        - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–º–µ—Ä–µ
wifi          - –°—Ç–∞—Ç—É—Å WiFi —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
clients       - –ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ WebSocket –∫–ª–∏–µ–Ω—Ç—ã
memory        - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
fps           - –¢–µ–∫—É—â–∏–π FPS –∫–∞–º–µ—Ä—ã
restart       - –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã status:

```
==================================================
ESP32-S3 Drone System Status
==================================================
System: ‚úÖ ONLINE - Uptime: 00:15:32
Camera: ‚úÖ Active - 28.7 FPS (QVGA, Quality: 8)
WiFi:   ‚úÖ AP Mode - SSID: ESP32-S3_Drone_30fps
        üì∂ Signal: Strong, 2 clients connected
Memory: üìä Heap: 180KB free / 512KB total
        üìä PSRAM: 7.2MB free / 8MB total
WebSocket: üåê Port 8080, 2 active connections
Network: üìà 1.2MB/s transmitted, 847 frames sent
Uptime: ‚è±Ô∏è 15m 32s
==================================================
```

## üåê –ö–ª–∏–µ–Ω—Ç—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 1. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤–µ–±-–∫–ª–∏–µ–Ω—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

- URL: `http://192.168.4.1:8080`
- –§—É–Ω–∫—Ü–∏–∏: —Å—Ç—Ä–∏–º –≤–∏–¥–µ–æ, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã

### 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π HTML –∫–ª–∏–µ–Ω—Ç

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª `drone_client.html`
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket

### 3. WebSocket API –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

```javascript
const ws = new WebSocket("ws://192.168.4.1:8080");

ws.onmessage = function (event) {
  if (event.data instanceof Blob) {
    // –ü–æ–ª—É—á–µ–Ω JPEG –∫–∞–¥—Ä
    const url = URL.createObjectURL(event.data);
    imageElement.src = url;
  }
};
```

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–∞–º–µ—Ä–∞ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è

```
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã
2. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–∏–Ω–æ–≤ –≤ CameraPins
3. –ö–∞—á–µ—Å—Ç–≤–æ –ø–∏—Ç–∞–Ω–∏—è (5V/2A –º–∏–Ω–∏–º—É–º)
4. Serial –ª–æ–≥ –Ω–∞ –æ—à–∏–±–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–∏–∑–∫–∏–π FPS –∏–ª–∏ –∑–∞–≤–∏—Å–∞–Ω–∏—è

```
–†–µ—à–µ–Ω–∏—è:
1. –£–≤–µ–ª–∏—á—å—Ç–µ JPEG_QUALITY (—É—Ö—É–¥—à–∏—Ç –∫–∞—á–µ—Å—Ç–≤–æ, –ø–æ–≤—ã—Å–∏—Ç FPS)
2. –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (FRAMESIZE_QQVGA)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–º–∞–∫—Å–∏–º—É–º 3)
4. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–∏—Ç–∞–Ω–∏—è
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Serial –∫–æ–º–∞–Ω–¥—É 'memory' –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ RAM
```

### –ü—Ä–æ–±–ª–µ–º–∞: WiFi –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

```
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –†–µ–≥–∏–æ–Ω WiFi (–º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ ESP32
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É 'wifi' –≤ Serial
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–Ω—Ç–µ–Ω–Ω—É (–µ—Å–ª–∏ –≤–Ω–µ—à–Ω—è—è)
```

### –ü—Ä–æ–±–ª–µ–º–∞: WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```
–†–µ—à–µ–Ω–∏—è:
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π WiFi —Å–µ—Ç–∏
2. IP –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 192.168.4.1
3. –ü–æ—Ä—Ç 8080 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Serial –ª–æ–≥ –Ω–∞ –æ—à–∏–±–∫–∏ WebSocket
```

## üì± –ú–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

- **Android**: WebView —Å JavaScript
- **iOS**: WKWebView —Å JavaScript
- **Flutter**: web_socket_channel –ø–∞–∫–µ—Ç
- **React Native**: WebSocket API

## üîß –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π Serial –∫–æ–º–∞–Ω–¥—ã

```cpp
// –í src/commands/command_handler.cpp
void CommandHandler::handleCustomCommand() {
    Serial.println("[CMD] –ú–æ—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞");
    // –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å
}

// –î–æ–±–∞–≤—å—Ç–µ –≤ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ Commands
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è

```cpp
// 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã: src/your_module/your_module.cpp –∏ include/your_module.h
// 2. –í include/system_manager.h –¥–æ–±–∞–≤—å—Ç–µ:
class YourModule;
YourModule* yourModule;

// 3. –í src/system/system_manager.cpp –≤ –º–µ—Ç–æ–¥–µ initialize():
yourModule = new YourModule();
yourModule->init();
```

## ‚öôÔ∏è –§–∞–π–ª platformio.ini

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤–∞—à–µ–º—É –ø—Ä–æ–µ–∫—Ç—É:

```ini
[env:esp32-s3-devkitc-1]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
board_build.flash_mode = qio
board_build.psram_type = opi
```

## üéØ –°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–ü–∞–º—è—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PSRAM –¥–ª—è –±–æ–ª—å—à–∏—Ö –±—É—Ñ–µ—Ä–æ–≤
2. **FPS**: –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –∫–∞—á–µ—Å—Ç–≤–æ–º –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
3. **–°–µ—Ç—å**: –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
4. **–ü–∏—Ç–∞–Ω–∏–µ**: –û–±–µ—Å–ø–µ—á—å—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ 5V/2A+
5. **–û—Ç–ª–∞–¥–∫–∞**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Serial –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Serial –ª–æ–≥ (115200 baud)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `status` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–∏–Ω–æ–≤ –≤–∞—à–µ–π –ø–ª–∞—Ç–µ
